{%- comment -%}Loop over the global font config and construct a series of @font-face declarations.
We later feed this to scss to minify the output and inline it in the head for performance.{%- endcomment -%}
{%- assign allFonts = fonts | values -%}
{%- for font in allFonts -%}
  {%- assign weights = font.weights | values -%}
  {%- for fontEntry in weights -%}
    {%- assign family = font.family -%}
    {%- assign format = fontEntry.url | split: "." | last -%}
    {%- assign localFontName = family | append: " " | append: fontEntry.variant | replace: "Regular", "" | strip -%}
    {%- assign postscriptVariantName = fontEntry.variant | replace: " ", "" -%}
    {%- assign postscriptName = family | replace: " ", "" | append: " " | append: postscriptVariantName | replace: "Regular", "" | strip | replace: " ", "-" -%}
    @font-face {
      font-family: '{{ family }}';
      font-style: {{ fontEntry.style }};
      font-weight: {{ fontEntry.weight }};
      font-display: {{ fontEntry.display }};
      src: local('{{ localFontName }}'), local('{{ postscriptName }}'), url('{{ fontEntry.url }}') format('{{ format }}');
    }
  {%- endfor -%}
{%- endfor -%}